import{d as k,b as x,r as $,e as A,o as c,f as g,w as P,g as v,h as o,u as B,i as C,t as V,j as d,k as b,l as m,c as h,v as D,F as p,m as j,n as N,a as T}from"./index-e4c7eea8.js";const U=k("searching",{state:()=>({searchArray:[],search:"",totalPages:1}),actions:{async getSearch(t=1){try{const s=await(await fetch(`https://api.themoviedb.org/3/search/multi?query=${this.search}&include_adult=false&language=ru&page=${t}`,x)).json();this.totalPages=s.total_pages;const r=s.results.filter(e=>e.poster_path!=null);console.log(s),t>1?this.searchArray.push(...r):this.searchArray=r}catch(a){console.log(a)}}}}),z={alt:"",class:"search__img"},E={class:"search__name"},F={__name:"SearchItem",props:{item:Object},setup(t){return(a,s)=>{const r=$("router-link"),e=A("lazy");return c(),g(r,{to:"",class:"search__item"},{default:P(()=>[v(o("img",z,null,512),[[e,B(C)+t.item.poster_path]]),o("h2",E,V(t.item.title||t.item.name),1)]),_:1})}}},H={class:"container"},L={class:"search"},q=["placeholder"],I={class:"search__wrapper"},M={key:0,class:"loading"},O=o("div",{class:"loading__spiner"},null,-1),W=[O],Y={__name:"SearchContent",props:{placeholder:String},setup(t){let a=null;function s(l,i){a&&clearTimeout(a),a=setTimeout(()=>{l()},i)}const r=d({get:()=>e.search,set:l=>{e.search=l,s(e.getSearch,500)}}),e=U(),f=d(()=>e.searchArray);b(()=>{e.searchArray=null,e.search=""});const u=m(1),n=m(!1);let y=d(()=>e.totalPages);async function w(){!n.value&&u.value<y.value&&(n.value=!0,u.value++,await e.getSearch(u.value),n.value=!1)}return window.addEventListener("scroll",()=>{document.body.clientHeight<=window.scrollY+window.innerHeight&&w()}),(l,i)=>(c(),h(p,null,[o("div",H,[o("div",L,[v(o("input",{"onUpdate:modelValue":i[0]||(i[0]=_=>r.value=_),type:"text",class:"search__input",placeholder:t.placeholder},null,8,q),[[D,r.value]]),o("div",I,[(c(!0),h(p,null,j(f.value,(_,S)=>(c(),g(F,{key:S,item:_},null,8,["item"]))),128))])])]),n.value?(c(),h("div",M,W)):N("",!0)],64))}},G={class:"main"},K={__name:"Search",setup(t){return(a,s)=>(c(),h("main",G,[T(Y,{placeholder:"Найти фильм, сериал..."})]))}};export{K as default};
